# Система управления ПТО (Производственно-технический отдел)

Система для управления документационным сопровождением строительных проектов.

## Стек технологий

- **Backend**: Python FastAPI
- **Frontend**: React (TypeScript)
- **База данных**: SQLite
- **ORM**: SQLAlchemy

## Функционал

- Управление проектами
- Исполнительная документация (ИД)
- Формы КС-2 (Акт о приемке выполненных работ)
- Формы КС-3 (Справка о стоимости выполненных работ)
- Графики производства работ (ГПР)
- Проекты производства работ (ППР)

## Структура проекта

```
PTD/
├── backend/          # FastAPI приложение
├── frontend/         # React приложение
├── docker-compose.yml
└── README.md
```

## Установка и запуск

### Предварительные требования

- Python 3.9+
- Node.js 18+

### Запуск

#### 1. Настройка Backend

База данных SQLite создается автоматически при первом запуске.

```bash
cd backend
python -m venv venv

# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate

pip install -r requirements.txt

# Запустить сервер
uvicorn app.main:app --reload
```

Backend будет доступен на http://localhost:8000
API документация (Swagger): http://localhost:8000/docs
Альтернативная документация (ReDoc): http://localhost:8000/redoc

#### 2. Настройка Frontend

В новом терминале:
```bash
cd frontend
npm install
npm start
```

Frontend будет доступен на http://localhost:3000

## Основные возможности

- **Проекты**: Управление строительными проектами с информацией о заказчике, подрядчике, сроках, конструктивах
- **Исполнительная документация (ИД)**: Ведение различных типов исполнительной документации (акты, схемы, журналы и т.д.)
- **КС-2**: Формирование актов о приемке выполненных работ с детализацией по позициям
- **КС-3**: Формирование справок о стоимости выполненных работ с расчетом НДС
- **ГПР**: Графики производства работ с задачами и зависимостями
- **ППР**: Проекты производства работ с разделами документации
- **Заявки**: Формирование заявок на материалы и услуги
- **Тендеры**: Проведение тендеров, реестр подрядчиков, коммерческие предложения
- **Договора**: Заключение договоров с подрядчиками
- **Сметы**: Составление смет (локальные, объектные, сводные) с позициями и сопутствующими затратами
- **Счета на оплату**: Формирование и проверка счетов на оплату
- **Кадры**: Учёт сотрудников (ФИО, должность, подразделение, дата приёма, статус), назначение на проекты
- **Подразделения**: Справочник подразделений (ПТО, ОГЭ, ОГМ, геодезия и т.д.)
- **Конструктивы объектов**: Управление конструктивами объектов
- **Нормативные расценки**: Справочник нормативных расценок
- **Проектная документация**: Управление проектной документацией (АР, КР, ВК, НВК, ЭС, ЭМ)
- **Исполнительные съемки**: Ведение исполнительных съемок геодезистами
- **Учет объемов работ (ВОР)**: Ведомость объемов работ с план/факт контролем
- **Изменения проекта**: Согласование изменений и перепланировок с workflow
- **Материалы и склады**: Учет движения материалов, списание ТМЦ, остатки на складах
- **Версии документов**: Версионность проектной и исполнительной документации
- **Workflow заявок**: Маршрутизация и согласование заявок
- **Интеграция с 1С**: Экспорт/импорт данных для бухгалтерии

## Структура API

Основные endpoints:
- `GET /api/v1/projects/` - Проекты
- `GET /api/v1/executive-docs/` - Исполнительная документация
- `GET /api/v1/ks2/` - Формы КС-2
- `GET /api/v1/ks3/` - Формы КС-3
- `GET /api/v1/gpr/` - Графики производства работ
- `GET /api/v1/ppr/` - Проекты производства работ
- `GET /api/v1/applications/` - Заявки
- `GET /api/v1/contracts/` - Договора
- `GET /api/v1/tenders/` - Тендеры
- `GET /api/v1/estimates/` - Сметы
- `GET /api/v1/invoices/` - Счета на оплату
- `GET /api/v1/personnel/` - Кадры (сотрудники)
- `GET /api/v1/personnel/by-department/{id}` - Сотрудники подразделения
- `GET /api/v1/projects/{id}/personnel` - Персонал на проекте
- `POST /api/v1/projects/{id}/personnel` - Назначить сотрудника на проект
- `GET /api/v1/departments/` - Подразделения
- `GET /api/v1/object-constructs/` - Конструктивы
- `GET /api/v1/standard-rates/` - Нормативные расценки
- `GET /api/v1/project-documentation/` - Проектная документация
- `GET /api/v1/executive-surveys/` - Исполнительные съемки
- `GET /api/v1/work-volumes/` - Учет объемов работ
- `GET /api/v1/project-changes/` - Изменения проекта
- `GET /api/v1/materials/materials/` - Материалы
- `GET /api/v1/materials/warehouses/` - Склады
- `GET /api/v1/workflow/applications/{id}/workflow` - Workflow заявок
- `GET /api/v1/document-versions/` - Версии документов
- `GET /api/v1/integration/1c/export/ks2/{id}` - Экспорт КС-2 в 1С
- `GET /api/v1/integration/1c/export/ks3/{id}` - Экспорт КС-3 в 1С

Полная документация API (Swagger) доступна по адресу http://localhost:8000/docs после запуска backend.