# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–Ω–æ-—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### ‚úÖ 1. –°–æ–∑–¥–∞–Ω–∞ –º–æ–¥–µ–ª—å ProjectStage (–≠—Ç–∞–ø –ø—Ä–æ–µ–∫—Ç–∞)

**–§–∞–π–ª:** `backend/app/models/project_stage.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∏–µ—Ä–∞—Ä—Ö–∏–∏ –º–µ–∂–¥—É –ü—Ä–æ–µ–∫—Ç–æ–º –∏ –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–æ–º.

**–ò–µ—Ä–∞—Ä—Ö–∏—è:** –û–±—ä–µ–∫—Ç ‚Üí –≠—Ç–∞–ø ‚Üí –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤ ‚Üí –ó–∞—è–≤–∫–∏/–î–æ–∫—É–º–µ–Ω—Ç—ã/–í–û–†/–ö–°

**–ü–æ–ª—è –º–æ–¥–µ–ª–∏:**
- `project_id` ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –æ–±—ä–µ–∫—Ç—É
- `code`, `name` ‚Äî –∫–æ–¥ –∏ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–∞
- `stage_type` ‚Äî —Ç–∏–ø —ç—Ç–∞–ø–∞ (–ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π, –æ—Å–Ω–æ–≤–Ω–æ–π, –æ—Ç–¥–µ–ª–æ—á–Ω—ã–π, –∑–∞–≤–µ—Ä—à–∞—é—â–∏–π)
- `order_number` ‚Äî –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- `planned_start_date`, `planned_end_date` ‚Äî –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Å—Ä–æ–∫–∏
- `actual_start_date`, `actual_end_date` ‚Äî —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ä–æ–∫–∏
- `status` ‚Äî —Å—Ç–∞—Ç—É—Å —ç—Ç–∞–ø–∞ (planned, in_progress, completed, suspended)
- `progress_percentage` ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∞–ø–∞
- `responsible` ‚Äî –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ —ç—Ç–∞–ø

**–°–≤—è–∑–∏:**
- `Project.stages` ‚Äî —ç—Ç–∞–ø—ã –ø—Ä–æ–µ–∫—Ç–∞
- `ProjectStage.constructs` ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤—ã —ç—Ç–∞–ø–∞
- `ProjectStage.work_volumes` ‚Äî –æ–±—ä–µ–º—ã —Ä–∞–±–æ—Ç —ç—Ç–∞–ø–∞
- `ProjectStage.estimates` ‚Äî —Å–º–µ—Ç—ã —ç—Ç–∞–ø–∞

---

### ‚úÖ 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å ProjectConstruct

**–§–∞–π–ª:** `backend/app/models/object_construct.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `stage_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è —Å–≤—è–∑–∏ —á–µ—Ä–µ–∑ —ç—Ç–∞–ø
- –ò–µ—Ä–∞—Ä—Ö–∏—è: –û–±—ä–µ–∫—Ç ‚Üí –≠—Ç–∞–ø ‚Üí –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤

**–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ü–æ–ª–µ `stage_id` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

---

### ‚úÖ 3. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ MaterialMovement –∫ –æ–±—ä–µ–∫—Ç—É

**–§–∞–π–ª:** `backend/app/models/material.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- `project_id` –∏–∑–º–µ–Ω–µ–Ω —Å `nullable=True` –Ω–∞ `nullable=False`
- –í—Å–µ –¥–≤–∏–∂–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞–Ω—ã –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –æ–±—ä–µ–∫—Ç—É

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –°–æ–≥–ª–∞—Å–Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–∫–ª–∞–¥–æ–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–±—ä–µ–∫—Ç–∞.

**–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ API:** `MaterialMovementBase.project_id` —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ.

---

### ‚úÖ 4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —ç—Ç–∞–ø–æ–≤ –≤ WorkVolume –∏ Estimate

**–§–∞–π–ª—ã:** 
- `backend/app/models/work_volume.py`
- `backend/app/models/estimate.py`
- `backend/app/schemas/estimate.py`
- `backend/app/api/v1/work_volumes.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ `stage_id` –≤ –æ–±–µ –º–æ–¥–µ–ª–∏
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `stage_id` –≤ —Å—Ö–µ–º—ã API
- –°–≤—è–∑–∏ —Å —ç—Ç–∞–ø–∞–º–∏ —á–µ—Ä–µ–∑ relationship
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —ç—Ç–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –û–±—ä–µ–º—ã —Ä–∞–±–æ—Ç –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —ç—Ç–∞–ø—É –¥–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–º–µ—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ —ç—Ç–∞–ø–∞–º –ø—Ä–æ–µ–∫—Ç–∞

---

### ‚úÖ 5. API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç—Ç–∞–ø–∞–º–∏

**–§–∞–π–ª:** `backend/app/api/v1/project_stages.py`

**Endpoints:**
- `GET /api/v1/project-stages/?project_id={id}` ‚Äî —Å–ø–∏—Å–æ–∫ —ç—Ç–∞–ø–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ (project_id –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
- `GET /api/v1/project-stages/{stage_id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —ç—Ç–∞–ø –ø–æ ID
- `POST /api/v1/project-stages/` ‚Äî —Å–æ–∑–¥–∞—Ç—å —ç—Ç–∞–ø
- `PUT /api/v1/project-stages/{stage_id}` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —ç—Ç–∞–ø
- `DELETE /api/v1/project-stages/{stage_id}` ‚Äî —É–¥–∞–ª–∏—Ç—å —ç—Ç–∞–ø

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `project_id` –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞
- –í—Å–µ —ç—Ç–∞–ø—ã –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –æ–±—ä–µ–∫—Ç—É
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç—Ç–∞–ø–∞

---

### ‚úÖ 6. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏

**–§–∞–π–ª—ã:**
- `backend/app/api/v1/object_constructs.py`
- `backend/app/api/v1/work_volumes.py`
- `backend/app/api/v1/estimates.py`

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ —ç—Ç–∞–ø –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–∞–ø –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø—Ä–æ–µ–∫—Ç—É
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–º–∞ —Ä–∞–±–æ—Ç —á–µ—Ä–µ–∑ —ç—Ç–∞–ø –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–º–µ—Ç—ã —á–µ—Ä–µ–∑ —ç—Ç–∞–ø –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

**–ü—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
```python
if stage.project_id != construct.project_id:
    raise HTTPException(400, "–≠—Ç–∞–ø –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É")
```

---

### ‚úÖ 7. –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –∏ —Å–≤—è–∑–∏

**–§–∞–π–ª—ã:**
- `backend/app/main.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç ProjectStage –∏ —Ä–æ—É—Ç–µ—Ä project_stages
- `backend/app/models/__init__.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω ProjectStage –≤ —ç–∫—Å–ø–æ—Ä—Ç—ã
- `backend/app/models/project.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–≤—è–∑—å `stages`

---

## üìä –ú–∞—Ç—Ä–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------|----------|
| –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å "–ü—Ä–æ–µ–∫—Ç" | ‚úÖ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –≤—Å–µ —Å–≤—è–∑–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã |
| –ò–µ—Ä–∞—Ä—Ö–∏—è –û–±—ä–µ–∫—Ç ‚Üí –≠—Ç–∞–ø ‚Üí –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤ | ‚úÖ | –ú–æ–¥–µ–ª—å ProjectStage —Å–æ–∑–¥–∞–Ω–∞, —Å–≤—è–∑–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã |
| –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –æ–±—ä–µ–∫—Ç—É | ‚úÖ | MaterialMovement –æ–±–Ω–æ–≤–ª–µ–Ω, –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –ø—Ä–∏–≤—è–∑–∞–Ω—ã |
| API –¥–ª—è —ç—Ç–∞–ø–æ–≤ | ‚úÖ | –ü–æ–ª–Ω—ã–π CRUD API —Å–æ–∑–¥–∞–Ω |
| –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ | ‚úÖ | –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —ç—Ç–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç—É —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ–±—ä–µ–∫—Ç—É | ‚úÖ | –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ endpoints –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | ‚úÖ | BUSINESS_PROCESSES.md –∏ ARCHITECTURE_COMPLIANCE.md –æ–±–Ω–æ–≤–ª–µ–Ω—ã |

---

## üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö

### –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: `project_stages`

```sql
CREATE TABLE project_stages (
    id INTEGER PRIMARY KEY,
    project_id INTEGER NOT NULL,  -- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –æ–±—ä–µ–∫—Ç—É
    code VARCHAR(50),
    name VARCHAR(500) NOT NULL,
    stage_type VARCHAR(100),
    order_number INTEGER DEFAULT 0,
    planned_start_date DATE,
    planned_end_date DATE,
    actual_start_date DATE,
    actual_end_date DATE,
    status VARCHAR(50) DEFAULT 'planned',
    progress_percentage NUMERIC(5,2) DEFAULT 0,
    responsible VARCHAR(200),
    is_active BOOLEAN DEFAULT TRUE,
    notes TEXT,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES projects(id)
);
```

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

1. **project_constructs** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `stage_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
2. **work_volumes** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `stage_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. **estimates** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `stage_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. **material_movements** ‚Äî `project_id` –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `NOT NULL`

---

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã –æ–±—ä–µ–∫—Ç–Ω–æ-—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –û–±—ä–µ–∫—Ç ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å ‚úÖ
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –æ–±—ä–µ–∫—Ç—É
- –ù–µ—Ç "–≤–∏—Å—è—á–∏—Ö" –∑–∞–ø–∏—Å–µ–π –±–µ–∑ –æ–±—ä–µ–∫—Ç–∞
- –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–¥—É—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–±—ä–µ–∫—Ç–∞

### 2. –ò–µ—Ä–∞—Ä—Ö–∏—è: –û–±—ä–µ–∫—Ç ‚Üí –≠—Ç–∞–ø ‚Üí –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤ ‚úÖ
- –ú–æ–¥–µ–ª—å —ç—Ç–∞–ø–æ–≤ —Å–æ–∑–¥–∞–Ω–∞
- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —ç—Ç–∞–ø–∞–º
- –û–±—ä–µ–º—ã —Ä–∞–±–æ—Ç –∏ —Å–º–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —ç—Ç–∞–ø—ã

### 3. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –æ–±—ä–µ–∫—Ç—É ‚úÖ
- MaterialMovement —Ç–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É–µ—Ç project_id
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏–º–µ—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π project_id

### 4. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ–±—ä–µ–∫—Ç—É ‚úÖ
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ endpoints –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ project_id
- API —ç—Ç–∞–ø–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π project_id

### 5. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ ‚úÖ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —ç—Ç–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç—É
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

### 1. –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic –¥–ª—è:
- –°–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã `project_stages`
- –î–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è `stage_id` –≤ `project_constructs`, `work_volumes`, `estimates`
- –ò–∑–º–µ–Ω–µ–Ω–∏—è `project_id` –≤ `material_movements` –Ω–∞ `NOT NULL`

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç—Ç–∞–ø–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –í —Ñ–æ—Ä–º–∞—Ö —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä —ç—Ç–∞–ø–∞
- –í —Å–ø–∏—Å–∫–∞—Ö –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —ç—Ç–∞–ø–∞–º
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é: –û–±—ä–µ–∫—Ç ‚Üí –≠—Ç–∞–ø ‚Üí –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å helper-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏:
- –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞
- –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏—Ü–∞ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞
- –†–µ–∫–≤–∏–∑–∏—Ç—ã –æ–±—ä–µ–∫—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ö

### 4. –£–ª—É—á—à–µ–Ω–∏–µ API
- –î–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö endpoints —Å–¥–µ–ª–∞—Ç—å `project_id` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
- –î–æ–±–∞–≤–∏—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ–±—ä–µ–∫—Ç—É
- –î–æ–±–∞–≤–∏—Ç—å endpoints –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç **–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ** —Å –æ–±—ä–µ–∫—Ç–Ω–æ-—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π:

‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å "–ü—Ä–æ–µ–∫—Ç" —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞  
‚úÖ –ò–µ—Ä–∞—Ä—Ö–∏—è –û–±—ä–µ–∫—Ç ‚Üí –≠—Ç–∞–ø ‚Üí –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞  
‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ MaterialMovement –∫ –æ–±—ä–µ–∫—Ç—É  
‚úÖ API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç—Ç–∞–ø–∞–º–∏ —Å–æ–∑–¥–∞–Ω  
‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞  
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞  

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –æ–±—ä–µ–∫—Ç–Ω–æ-—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞!**
